<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>SRS Preview - Professional Document</title>
    <link rel="stylesheet" href="srs-style.css">
    <link rel="stylesheet" href="mobile-first.css">
    <link rel="stylesheet" href="preview-mobile-first.css">
    <style>
        /* SRS Preview Page Styles */
        .srs-preview-container {
            max-width: 1000px;
            margin: 0 auto;
            /* padding: var(--space-xl); */
            background: #ffffff;
            min-height: 100vh;
        }

        .srs-header {
            text-align: center;
            margin-bottom: var(--space-2xl);
            /* padding: var(--space-xl); */
            background: #f8f9fa;
            border: 2px solid #3498db;
            border-radius: var(--radius-lg);
        }

        .srs-title {
            font-size: 2.5rem;
            color: #2c3e50;
            /* margin-bottom: var(--space-md); */
        }

        .srs-subtitle {
            color: #7f8c8d;
            font-size: var(--font-size-lg);
        }

        .document-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: var(--space-xl);
            border-bottom: 2px solid #3498db;
        }

        .tab-btn {
            padding: var(--space-md) var(--space-lg);
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: #7f8c8d;
            font-family: var(--font-mono);
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .tab-btn:hover {
            color: #2980b9;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .srs-document {
            background: #ffffff;
            border: 2px solid #333333;
            border-radius: 8px;
            /* padding: 40px; */
            /* margin-bottom: 30px; */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            font-family: 'Times New Roman', serif;
            line-height: 1.6;
            color: #333333;
        }

        .srs-document h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 20px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .srs-document h2 {
            color: #2980b9;
            font-size: 1.8rem;
            margin-top: 40px;
            margin-bottom: 20px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-weight: bold;
            counter-increment: section;
        }

        .srs-document h3 {
            color: #34495e;
            font-size: 1.4rem;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: bold;
            counter-increment: subsection;
        }

        .srs-document h4 {
            color: #7f8c8d;
            font-size: 1.2rem;
            margin-top: 25px;
            margin-bottom: 10px;
            font-weight: bold;
            counter-increment: subsubsection;
        }

        .srs-document p {
            /* margin-bottom: 15px; */
            text-align: justify;
            text-indent: 20px;
        }

        .srs-document ul, .srs-document ol {
            margin-bottom: 20px;
            padding-left: 30px;
        }

        .srs-document li {
            margin-bottom: 8px;
        }

        .srs-document strong {
            color: #2c3e50;
            font-weight: bold;
        }

        .highlight-box {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            /* padding: 20px; */
            /* margin: 25px 0; */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .document-header {
            text-align: center;
            /* margin-bottom: 40px; */
            /* padding: 20px; */
            background: #ecf0f1;
            border-radius: 6px;
            border: 1px solid #bdc3c7;
        }

        .document-header h1 {
            /* margin-bottom: 20px; */
            border: none;
            padding: 0;
        }

        .document-header .project-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            margin-top: 5px;
        }

        .document-header .info-item {
            text-align: left;
            /* padding: 10px; */
            background: white;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .document-header .info-label {
            font-weight: bold;
            color: #2c3e50;
            display: block;
            margin-bottom: 5px;
        }

        .document-header .info-value {
            color: #7f8c8d;
        }

        .requirement-item {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 4px 4px 0;
        }

        .requirement-id {
            font-weight: bold;
            color: #2980b9;
            margin-bottom: 5px;
        }

        .requirement-text {
            color: #2c3e50;
        }

        .table-container {
            margin: 20px 0;
            overflow-x: auto;
        }

        .srs-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }

        .srs-table th,
        .srs-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .srs-table th {
            background: #3498db;
            color: white;
            font-weight: bold;
        }

        .srs-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .srs-table tr:hover {
            background: #e3f2fd;
        }

        .page-break {
            page-break-before: always;
        }

        .toc {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }

        .toc h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .toc ul {
            list-style: none;
            padding-left: 0;
        }

        .toc li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .toc li:before {
            content: "‚Ä¢";
            color: #3498db;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .toc a {
            color: #2980b9;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        /* Numbering for sections */
        .srs-document {
            counter-reset: section subsection subsubsection;
        }

        .srs-document h2:before {
            content: counter(section) ". ";
        }

        .srs-document h3:before {
            content: counter(section) "." counter(subsection) " ";
        }

        .srs-document h4:before {
            content: counter(section) "." counter(subsection) "." counter(subsubsection) " ";
        }

        .action-buttons {
            display: flex;
            gap: var(--space-md);
            justify-content: center;
            margin-top: var(--space-xl);
            padding: var(--space-xl);
            background: #f8f9fa;
            border: 2px solid #3498db;
            border-radius: var(--radius-lg);
        }

        .btn-primary {
            padding: var(--space-md) var(--space-xl);
            background: linear-gradient(45deg, #3498db, #2980b9);
            border: none;
            border-radius: var(--radius-sm);
            color: #ffffff;
            font-family: var(--font-mono);
            font-size: var(--font-size-base);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            box-shadow: 0 4px 6px rgba(52, 152, 219, 0.1);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px rgba(52, 152, 219, 0.1);
        }

        .btn-secondary {
            padding: var(--space-md) var(--space-xl);
            background: transparent;
            border: 2px solid #3498db;
            border-radius: var(--radius-sm);
            color: #3498db;
            font-family: var(--font-mono);
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .btn-secondary:hover {
            background: #3498db;
            color: #ffffff;
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.3);
        }

        .loading {
            text-align: center;
            padding: var(--space-2xl);
            color: #7f8c8d;
        }
        
        .loading-steps {
            margin-top: 20px;
        }
        
        .loading-steps .step {
            padding: 8px 0;
            color: #666;
            font-size: 14px;
            animation: pulse 2s infinite;
        }
        
        .loading-steps .step:nth-child(1) { animation-delay: 0s; }
        .loading-steps .step:nth-child(2) { animation-delay: 0.5s; }
        .loading-steps .step:nth-child(3) { animation-delay: 1s; }
        .loading-steps .step:nth-child(4) { animation-delay: 1.5s; }
        .loading-steps .step:nth-child(5) { animation-delay: 2s; }
        .loading-steps .step:nth-child(6) { animation-delay: 2.5s; }
        .loading-steps .step:nth-child(7) { animation-delay: 3s; }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .error {
            text-align: center;
            padding: var(--space-2xl);
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
            border: 2px solid #e74c3c;
            border-radius: var(--radius-md);
        }

        .test-section {
            text-align: center;
            padding: var(--space-2xl);
        }

        /* Print Styles */
        @media print {
            .action-buttons, .document-tabs, .test-section {
                display: none;
            }
            
            .srs-preview-container {
                max-width: none;
                padding: 0;
            }
            
            .srs-document {
                box-shadow: none;
                border: 1px solid #ccc;
            }
        }
    </style>
</head>
<body>
    <div class="srs-preview-container">
        <div class="srs-header">
            <h1 class="srs-title">üìÑ SRS Document Preview</h1>
            <p class="srs-subtitle">Review your Software Requirements Specification before submission</p>
        </div>

        <div id="loadingMessage" class="loading">
            <h2>‚è≥ Generating SRS Document...</h2>
            <p>Please wait while we create your professional SRS document.</p>
        </div>

        <div id="errorMessage" class="error" style="display: none;">
            <h2>‚ùå Error Loading SRS</h2>
            <p>There was an error generating your SRS document. Please try again.</p>
        </div>

        <div id="testSection" class="test-section" style="display: none;">
            <button id="testBtn" class="btn-secondary">
                <span class="btn-icon">üß™</span>
                <span class="btn-text">Test with Sample Data</span>
            </button>
            <button id="refreshBtn" class="btn-secondary">
                <span class="btn-icon">üîÑ</span>
                <span class="btn-text">Force Refresh & Clear Cache</span>
            </button>
        </div>

        <!-- Document Tabs -->
        <div id="documentTabs" class="document-tabs" style="display: none;">
            <button class="tab-btn active" data-tab="srs">SRS Document</button>
            <button class="tab-btn" data-tab="contract">Project Agreement</button>
            <button class="tab-btn" data-tab="pricing">Pricing & Timeline</button>
            <!-- <button class="tab-btn" data-tab="roadmap">Developer Roadmap</button> -->
            <button class="tab-btn" data-tab="summary">Project Summary</button>
            <button class="tab-btn" data-tab="terms">Terms & Conditions</button>
            <button class="tab-btn" data-tab="privacy">Privacy Policy</button>
        </div>

        <!-- Document Contents -->
        <div id="documentContent" style="display: none;">
            <div class="tab-content active" id="srs-tab">
                <div id="srsDocument" class="srs-document">
                    <!-- SRS content will be generated here -->
                </div>
            </div>
            
            <div class="tab-content" id="contract-tab">
                <div id="contractDocument" class="srs-document">
                    <!-- Contract content will be generated here -->
                </div>
            </div>
            
            <div class="tab-content" id="pricing-tab">
                <div id="pricingDocument" class="srs-document">
                    <!-- Pricing and timeline content will be generated here -->
                </div>
            </div>
            
            <!-- <div class="tab-content" id="roadmap-tab"> -->
                <!-- <div id="roadmapDocument" class="srs-document"> -->
                    <!-- Developer roadmap content will be generated here -->
                <!-- </div> -->
            <!-- </div> -->
            
            <div class="tab-content" id="summary-tab">
                <div id="summaryDocument" class="srs-document">
                    <!-- Summary content will be generated here -->
                </div>
            </div>
            
            <div class="tab-content" id="terms-tab">
                <div id="termsDocument" class="srs-document">
                    <!-- Terms and Conditions content will be generated here -->
                </div>
            </div>
            
            <div class="tab-content" id="privacy-tab">
                <div id="privacyDocument" class="srs-document">
                    <!-- Privacy Policy content will be generated here -->
                </div>
            </div>
        </div>

        <div id="actionButtons" class="action-buttons" style="display: none;">
            <button id="printBtn" class="btn-secondary">
                <span class="btn-icon">üñ®Ô∏è</span>
                <span class="btn-text">Print Document</span>
            </button>
            <button id="downloadBtn" class="btn-secondary">
                <span class="btn-icon">üì•</span>
                <span class="btn-text">Download PDF</span>
            </button>
            <button id="submitBtn" class="btn-primary">
                <span class="btn-icon">üì§</span>
                <span class="btn-text">Submit Complete Package</span>
            </button>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="enhanced-gemini.js"></script>
    <script src="complete-submission.js"></script>
    <script>
        class SRSPreview {
            constructor() {
                this.formData = null;
                this.loadingMessage = document.getElementById('loadingMessage');
                this.errorMessage = document.getElementById('errorMessage');
                this.documentTabs = document.getElementById('documentTabs');
                this.documentContent = document.getElementById('documentContent');
                this.srsDocument = document.getElementById('srsDocument');
                this.contractDocument = document.getElementById('contractDocument');
                this.pricingDocument = document.getElementById('pricingDocument');
                this.roadmapDocument = document.getElementById('roadmapDocument');
                this.summaryDocument = document.getElementById('summaryDocument');
                this.termsDocument = document.getElementById('termsDocument');
                this.privacyDocument = document.getElementById('privacyDocument');
                this.actionButtons = document.getElementById('actionButtons');
                this.submitBtn = document.getElementById('submitBtn');
                this.printBtn = document.getElementById('printBtn');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.testSection = document.getElementById('testSection');
                this.testBtn = document.getElementById('testBtn');
                this.refreshBtn = document.getElementById('refreshBtn');
                
                // Initialize enhanced Gemini service
                this.enhancedGemini = new EnhancedGeminiService();
                
                // Initialize complete submission service
                this.completeSubmission = new CompleteSubmissionService(this);
                
                this.init();
            }

            init() {
                console.log('SRS Preview initialized');
                console.log('Current timestamp:', Date.now());
                console.log('Page URL:', window.location.href);
                
                // Clear any old localStorage data
                this.clearOldData();
                
                this.setupEventListeners();
                this.loadFormData();
            }

            clearOldData() {
                console.log('Clearing old localStorage data...');
                
                // Get the current data key from URL to avoid clearing it
                const urlParams = new URLSearchParams(window.location.search);
                const currentDataKey = urlParams.get('key');
                
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith('srs_preview_data_') && key !== currentDataKey) {
                        keysToRemove.push(key);
                    }
                }
                
                keysToRemove.forEach(key => {
                    console.log('Removing old key:', key);
                    localStorage.removeItem(key);
                });
                
                console.log('Cleared', keysToRemove.length, 'old entries (preserved current key)');
            }

            loadFormData() {
                try {
                    console.log('=== LOADING FORM DATA ===');
                    console.log('Current URL:', window.location.href);
                    console.log('URL search params:', window.location.search);
                    
                    const urlParams = new URLSearchParams(window.location.search);
                    const dataKey = urlParams.get('key');
                    console.log('Data key from URL:', dataKey);
                    
                    if (!dataKey) {
                        console.error('No data key found in URL');
                        this.showError('No data key found in URL. Please go back to the form and try again.');
                        this.testSection.style.display = 'block';
                        return;
                    }
                    
                    console.log('Looking for data in localStorage with key:', dataKey);
                    const storedData = localStorage.getItem(dataKey);
                    console.log('Stored data found:', !!storedData);
                    console.log('Stored data length:', storedData ? storedData.length : 0);
                    
                    if (!storedData) {
                        console.error('No data found in localStorage with key:', dataKey);
                        this.showError(`No data found in localStorage with key: ${dataKey}`);
                        this.testSection.style.display = 'block';
                        return;
                    }
                    
                    console.log('Parsing stored data...');
                    this.formData = JSON.parse(storedData);
                    console.log('Parsed form data:', this.formData);
                    console.log('Form data keys:', Object.keys(this.formData));
                    console.log('Main features:', this.formData.main_features);
                    console.log('Main features type:', typeof this.formData.main_features);
                    console.log('Main features length:', this.formData.main_features ? this.formData.main_features.length : 'undefined');
                    console.log('Sub features:', this.formData.sub_features);
                    console.log('Sub features type:', typeof this.formData.sub_features);
                    console.log('Sub features length:', this.formData.sub_features ? this.formData.sub_features.length : 'undefined');
                    
                    // Validate that we have the essential data
                    if (!this.formData.projectName && !this.formData.clientName) {
                        console.error('Invalid form data - missing essential fields');
                        this.showError('Invalid form data. Please go back to the form and try again.');
                        this.testSection.style.display = 'block';
                        return;
                    }
                    
                    console.log('Form data loaded successfully, generating documents...');
                    localStorage.removeItem(dataKey); // Clean up
                    this.generateDocuments();
                    
                } catch (error) {
                    console.error('Error loading form data:', error);
                    this.showError(`Failed to load form data: ${error.message}`);
                    this.testSection.style.display = 'block';
                }
            }

            setupEventListeners() {
                this.submitBtn.addEventListener('click', () => this.submitSRS());
                this.printBtn.addEventListener('click', () => this.printCurrentDocument());
                this.downloadBtn.addEventListener('click', () => this.downloadCurrentDocument());
                
                // Tab switching
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const tab = btn.dataset.tab;
                        this.switchTab(tab);
                    });
                });
                
                // Test button
                if (this.testBtn) {
                    this.testBtn.addEventListener('click', () => this.loadTestData());
                }
                
                // Refresh button
                if (this.refreshBtn) {
                    this.refreshBtn.addEventListener('click', () => this.forceRefresh());
                }
            }

            async generateDocuments() {
                if (!this.formData) {
                    this.showError('No form data available');
                    return;
                }

                try {
                    console.log('Starting AI-powered document generation...');
                    console.log('Form data:', this.formData);
                    
                    // Show loading state
                    this.loadingMessage.style.display = 'block';
                    this.loadingMessage.innerHTML = `
                        <div class="loading">
                            <h2>ü§ñ AI is generating your documents...</h2>
                            <p>Creating personalized SRS, Agreement, Pricing, Roadmap, Summary, Terms & Privacy Policy</p>
                        <div class="loading-steps">
                            <div class="step">üìã Generating SRS Document...</div>
                            <div class="step">üìÑ Creating Project Agreement...</div>
                            <div class="step">üí∞ Calculating Pricing & Timeline...</div>
                            <div class="step">üó∫Ô∏è Building Developer Roadmap...</div>
                            <div class="step">üìä Preparing Project Summary...</div>
                            <div class="step">‚öñÔ∏è Generating Terms & Conditions...</div>
                            <div class="step">üîí Creating Privacy Policy...</div>
                        </div>
                        </div>
                    `;
                    
                    // Generate all documents using AI
                    const documents = await this.enhancedGemini.generateAllDocuments(this.formData);
                    
                    console.log('AI-generated documents:', documents);
                    
                    // Display the AI-generated content
                    this.srsDocument.innerHTML = documents.srsDocument || this.createSRSContent(this.formData);
                    this.contractDocument.innerHTML = documents.projectAgreement || this.createContractContent(this.formData);
                    this.pricingDocument.innerHTML = documents.pricingTimeline || this.createPricingContent(this.formData);
                    this.roadmapDocument.innerHTML = documents.developerRoadmap || this.createRoadmapContent(this.formData);
                    this.summaryDocument.innerHTML = documents.projectSummary || this.createSummaryContent(this.formData);
                    this.termsDocument.innerHTML = documents.termsConditions || this.createTermsContent(this.formData);
                    this.privacyDocument.innerHTML = documents.privacyPolicy || this.createPrivacyContent(this.formData);
                    
                    // Hide loading and show documents
                    this.loadingMessage.style.display = 'none';
                    this.documentTabs.style.display = 'flex';
                    this.documentContent.style.display = 'block';
                    this.actionButtons.style.display = 'flex';
                    
                    console.log('All AI documents generated successfully');
                    
                } catch (error) {
                    console.error('Error generating AI documents:', error);
                    console.log('Falling back to static document generation...');
                    this.generateStaticDocuments();
                }
            }

            generateStaticDocuments() {
                try {
                    console.log('Generating static documents as fallback...');
                    
                    // Generate content using static methods
                    const srsContent = this.createSRSContent(this.formData);
                    const contractContent = this.createContractContent(this.formData);
                    const pricingContent = this.createPricingContent(this.formData);
                    const roadmapContent = this.createRoadmapContent(this.formData);
                    const summaryContent = this.createSummaryContent(this.formData);
                    
                    // Display content
                    this.srsDocument.innerHTML = srsContent;
                    this.contractDocument.innerHTML = contractContent;
                    this.pricingDocument.innerHTML = pricingContent;
                    this.roadmapDocument.innerHTML = roadmapContent;
                    this.summaryDocument.innerHTML = summaryContent;
                    this.termsDocument.innerHTML = this.createTermsContent(this.formData);
                    this.privacyDocument.innerHTML = this.createPrivacyContent(this.formData);
                    
                    // Show documents
                    this.loadingMessage.style.display = 'none';
                    this.documentTabs.style.display = 'flex';
                    this.documentContent.style.display = 'block';
                    this.actionButtons.style.display = 'flex';
                    
                    console.log('Static documents generated successfully');
                    
                } catch (error) {
                    console.error('Error generating static documents:', error);
                    this.showError(`Failed to generate documents: ${error.message}`);
                }
            }

            createSRSContent(data) {
                console.log('Creating SRS content with data:', data);
                
                // Create a simple, clean HTML structure
                const content = `
                    <div class="srs-document">
                        <div class="document-header">
                            <h1>SOFTWARE REQUIREMENTS SPECIFICATION</h1>
                            <div class="project-info">
                                <div class="info-item">
                                    <strong>Project Name:</strong> ${data.projectName || 'Not specified'}
                                </div>
                                <div class="info-item">
                                    <strong>Client:</strong> ${data.clientName || 'Not specified'}
                                </div>
                                <div class="info-item">
                                    <strong>Document Version:</strong> 1.0 - ${new Date().toLocaleDateString()}
                                </div>
                                <div class="info-item">
                                    <strong>Prepared By:</strong> Suresh Yadav (Flutter Developer)
                                </div>
                            </div>
                        </div>

                        <div class="document-body">
                            <h2>1. Introduction</h2>
                            
                            <h3>1.1 Purpose</h3>
                            <p>This Software Requirements Specification (SRS) document describes the functional and non-functional requirements for the development of <strong>${data.projectName || 'the application'}</strong>.</p>
                            <p>The application is designed as a ${data.projectType || 'mobile application'} to ${data.projectDescription || 'meet specific business requirements'}.</p>
                            
                            <h3>1.2 Scope</h3>
                            <p>This SRS covers the complete development lifecycle of <strong>${data.projectName || 'the application'}</strong>, including:</p>
                            <ul>
                                <li>Functional requirements and specifications</li>
                                <li>User interface and user experience requirements</li>
                                <li>Performance and security requirements</li>
                                <li>Integration and deployment requirements</li>
                            </ul>

                            <h2>2. Overall Description</h2>
                            
                            <h3>2.1 Product Perspective</h3>
                            <p><strong>${data.projectName || 'The application'}</strong> is a ${data.projectType || 'standalone mobile application'} designed to serve ${data.targetAudience || 'end users'} in the ${data.primaryMarkets || 'target market'}.</p>

                            <h3>2.2 Product Functions</h3>
                            <p>The application shall provide the following core functionality:</p>
                            <ul>
                                ${this.generateFeatureList(data)}
                            </ul>

                            <h2>3. Specific Requirements</h2>
                            
                            <h3>3.1 Functional Requirements</h3>
                            <p>The following functional requirements define what the system shall do:</p>
                            ${this.generateFunctionalRequirements(data)}

                            <h3>3.2 Non-Functional Requirements</h3>
                            
                            <h4>3.2.1 Performance Requirements</h4>
                            <ul>
                                <li>Application startup time: Less than 3 seconds</li>
                                <li>Screen transition time: Less than 1 second</li>
                                <li>Data loading time: Less than 2 seconds for standard operations</li>
                                <li>Response time: Less than 500ms for user interactions</li>
                            </ul>

                            <h4>3.2.2 Security Requirements</h4>
                            <ul>
                                <li>All data transmission must use HTTPS/TLS encryption</li>
                                <li>Secure user authentication with password hashing</li>
                                <li>Role-based access control for different user types</li>
                                <li>Sensitive data must be encrypted at rest</li>
                            </ul>

                            <h2>4. Appendices</h2>
                            
                            <h3>4.1 Glossary</h3>
                            <ul>
                                <li><strong>SRS:</strong> Software Requirements Specification</li>
                                <li><strong>API:</strong> Application Programming Interface</li>
                                <li><strong>UI/UX:</strong> User Interface/User Experience</li>
                                <li><strong>Flutter:</strong> Google's UI toolkit for building natively compiled applications</li>
                            </ul>
                        </div>
                    </div>
                `;
                
                console.log('SRS content generated, length:', content.length);
                return content;
            }

            generateFeatureList(data) {
                console.log('generateFeatureList called with data:', data);
                console.log('main_features:', data.main_features);
                console.log('main_features type:', typeof data.main_features);
                console.log('main_features length:', data.main_features ? data.main_features.length : 'undefined');
                
                if (!data.main_features || data.main_features.length === 0) {
                    console.log('No main features found, returning fallback');
                    return '<li>Core application functionality to be determined during detailed planning phase</li>';
                }
                
                console.log('Generating feature list for:', data.main_features);
                const featureList = data.main_features.map(feature => {
                    return `<li><strong>${this.getFeatureDisplayName(feature)}:</strong> ${this.getFeatureDescription(feature)}</li>`;
                }).join('');
                
                console.log('Generated feature list:', featureList);
                return featureList;
            }

            generateFunctionalRequirements(data) {
                if (!data.main_features || data.main_features.length === 0) {
                    return '<p>Functional requirements to be detailed during the design phase.</p>';
                }
                
                return data.main_features.map((feature, index) => {
                    return `
                        <div class="requirement-item">
                            <h4>FR-${index + 1}: ${this.getFeatureDisplayName(feature)}</h4>
                            <p>The system shall provide functionality to ${this.getFeatureDescription(feature)}. This includes all necessary user interface components, data validation, and error handling mechanisms.</p>
                        </div>
                    `;
                }).join('');
            }

            getFeatureDisplayName(feature) {
                const featureMap = {
                    'authentication': 'User Authentication & Login',
                    'user_management': 'User Profile Management',
                    'search_filter': 'Search & Filter System',
                    'payment_system': 'Payment & E-commerce',
                    'notifications': 'Push Notifications',
                    'messaging': 'In-App Messaging & Chat',
                    'location_services': 'Location & GPS Services',
                    'media_handling': 'Media & Content Handling',
                    'social_integration': 'Social Media Integration',
                    'analytics': 'Analytics & Reporting',
                    'offline_mode': 'Offline Functionality',
                    'admin_panel': 'Admin Panel & Dashboard'
                };
                return featureMap[feature] || feature;
            }

            getFeatureDescription(feature) {
                const descriptionMap = {
                    'authentication': 'authenticate and manage user accounts',
                    'user_management': 'manage user profiles and preferences',
                    'search_filter': 'search and filter content effectively',
                    'payment_system': 'process payments and manage transactions',
                    'notifications': 'receive push notifications',
                    'messaging': 'communicate with other users',
                    'location_services': 'access location-based features',
                    'media_handling': 'upload and manage media files',
                    'social_integration': 'integrate with social media platforms',
                    'analytics': 'view usage analytics and reports',
                    'offline_mode': 'use core features without internet',
                    'admin_panel': 'access administrative functions'
                };
                return descriptionMap[feature] || 'use this feature';
            }

            createTermsContent(data) {
                const currentDate = new Date().toLocaleDateString();
                const projectName = data.projectName || 'Flutter Project';
                const clientName = data.clientName || 'Client';
                
                return `
                    <h1>Terms and Conditions</h1>
                    
                    <div class="document-info">
                        <p><strong>Project:</strong> ${projectName}</p>
                        <p><strong>Client:</strong> ${clientName}</p>
                        <p><strong>Effective Date:</strong> ${currentDate}</p>
                        <p><strong>Last Updated:</strong> ${currentDate}</p>
                    </div>
                    
                    <h2>1. Service Agreement</h2>
                    <p>These Terms and Conditions ("Terms") govern the software development services provided by Suresh Yadav ("Developer", "we", "us") to ${clientName} ("Client", "you") for the development of ${projectName}.</p>
                    
                    <h2>2. Project Scope</h2>
                    <p>The project scope includes:</p>
                    <ul>
                        <li>Software Requirements Specification (SRS) development</li>
                        <li>Mobile/Web application development using Flutter framework</li>
                        <li>UI/UX design and implementation</li>
                        <li>Backend integration and API development</li>
                        <li>Testing and quality assurance</li>
                        <li>Deployment and maintenance support</li>
                    </ul>
                    
                    <h2>3. Client Responsibilities</h2>
                    <p>The Client agrees to:</p>
                    <ul>
                        <li>Provide accurate and complete project requirements</li>
                        <li>Respond to requests for information within 48 hours</li>
                        <li>Provide necessary access to systems and data</li>
                        <li>Make timely payments as per agreed schedule</li>
                        <li>Provide feedback during development phases</li>
                        <li>Test and approve deliverables within specified timeframes</li>
                    </ul>
                    
                    <h2>4. Developer Responsibilities</h2>
                    <p>The Developer agrees to:</p>
                    <ul>
                        <li>Deliver high-quality software solutions</li>
                        <li>Follow industry best practices and coding standards</li>
                        <li>Provide regular project updates and progress reports</li>
                        <li>Maintain confidentiality of client information</li>
                        <li>Deliver projects within agreed timelines</li>
                        <li>Provide post-deployment support as specified</li>
                    </ul>
                    
                    <h2>5. Payment Terms</h2>
                    <p>Payment terms are as follows:</p>
                    <ul>
                        <li>Initial payment: 30% upon project commencement</li>
                        <li>Milestone payments: 40% upon completion of major phases</li>
                        <li>Final payment: 30% upon project completion and delivery</li>
                        <li>Payment method: Bank transfer or digital payment</li>
                        <li>Late payment fee: 2% per month on overdue amounts</li>
                    </ul>
                    
                    <h2>6. Intellectual Property</h2>
                    <p>Upon full payment, the Client will own:</p>
                    <ul>
                        <li>All source code developed for the project</li>
                        <li>Custom designs and UI/UX elements</li>
                        <li>Project documentation and specifications</li>
                        <li>Database schemas and configurations</li>
                    </ul>
                    <p>The Developer retains rights to:</p>
                    <ul>
                        <li>General development methodologies and frameworks</li>
                        <li>Reusable code libraries and components</li>
                        <li>Development tools and processes</li>
                    </ul>
                    
                    <h2>7. Confidentiality</h2>
                    <p>Both parties agree to maintain strict confidentiality regarding:</p>
                    <ul>
                        <li>Project specifications and requirements</li>
                        <li>Business processes and strategies</li>
                        <li>Technical implementations and solutions</li>
                        <li>Any proprietary information shared during development</li>
                    </ul>
                    
                    <h2>8. Project Timeline</h2>
                    <p>The estimated project timeline is based on:</p>
                    <ul>
                        <li>Project complexity and feature requirements</li>
                        <li>Client responsiveness and feedback speed</li>
                        <li>Third-party integrations and dependencies</li>
                        <li>Testing and quality assurance requirements</li>
                    </ul>
                    <p>Timeline extensions may be required for:</p>
                    <ul>
                        <li>Scope changes or additional requirements</li>
                        <li>Delays in client feedback or approvals</li>
                        <li>Third-party service dependencies</li>
                        <li>Technical challenges beyond initial assessment</li>
                    </ul>
                    
                    <h2>9. Warranty and Support</h2>
                    <p>The Developer provides:</p>
                    <ul>
                        <li>90-day warranty for bug fixes and critical issues</li>
                        <li>Technical support for implementation questions</li>
                        <li>Documentation and user guides</li>
                        <li>Basic training on system usage</li>
                    </ul>
                    <p>Support does not include:</p>
                    <ul>
                        <li>New feature development beyond original scope</li>
                        <li>Third-party service issues</li>
                        <li>Client-side infrastructure problems</li>
                        <li>Modifications by other developers</li>
                    </ul>
                    
                    <h2>10. Termination</h2>
                    <p>Either party may terminate this agreement:</p>
                    <ul>
                        <li>With 30 days written notice</li>
                        <li>Immediately for material breach of contract</li>
                        <li>For non-payment after 15 days notice</li>
                    </ul>
                    <p>Upon termination:</p>
                    <ul>
                        <li>Client pays for completed work</li>
                        <li>Developer delivers completed deliverables</li>
                        <li>Confidentiality obligations continue</li>
                    </ul>
                    
                    <h2>11. Limitation of Liability</h2>
                    <p>The Developer's liability is limited to:</p>
                    <ul>
                        <li>Direct damages up to the total project value</li>
                        <li>Correction of defects within warranty period</li>
                        <li>Reasonable efforts to resolve technical issues</li>
                    </ul>
                    <p>The Developer is not liable for:</p>
                    <ul>
                        <li>Indirect or consequential damages</li>
                        <li>Loss of profits or business opportunities</li>
                        <li>Third-party service failures</li>
                        <li>Client's business decisions</li>
                    </ul>
                    
                    <h2>12. Governing Law</h2>
                    <p>These Terms are governed by the laws of Nepal. Any disputes will be resolved through:</p>
                    <ul>
                        <li>Good faith negotiations</li>
                        <li>Mediation if negotiations fail</li>
                        <li>Arbitration as final recourse</li>
                    </ul>
                    
                    <h2>13. Amendments</h2>
                    <p>These Terms may be amended by:</p>
                    <ul>
                        <li>Written agreement of both parties</li>
                        <li>Email confirmation of changes</li>
                        <li>Updated project specifications</li>
                    </ul>
                    
                    <h2>14. Contact Information</h2>
                    <div class="contact-info">
                        <p><strong>Developer:</strong> Suresh Yadav</p>
                        <p><strong>Email:</strong> sureshyadav.info.np</p>
                        <p><strong>Services:</strong> Flutter Development, Web Development, AI Solutions</p>
                        <p><strong>Location:</strong> Nepal</p>
                    </div>
                    
                    <div class="signature-section">
                        <p><strong>Client Signature:</strong> _________________________</p>
                        <p><strong>Date:</strong> _________________________</p>
                        <p><strong>Developer Signature:</strong> _________________________</p>
                        <p><strong>Date:</strong> _________________________</p>
                    </div>
                    
                    <div class="footer-note">
                        <p><em>By proceeding with the project, both parties acknowledge that they have read, understood, and agree to be bound by these Terms and Conditions.</em></p>
                    </div>
                `;
            }

            createPrivacyContent(data) {
                const currentDate = new Date().toLocaleDateString();
                const projectName = data.projectName || 'Flutter Project';
                const clientName = data.clientName || 'Client';
                
                return `
                    <h1>Privacy Policy</h1>
                    
                    <div class="document-info">
                        <p><strong>Project:</strong> ${projectName}</p>
                        <p><strong>Client:</strong> ${clientName}</p>
                        <p><strong>Effective Date:</strong> ${currentDate}</p>
                        <p><strong>Last Updated:</strong> ${currentDate}</p>
                    </div>
                    
                    <h2>1. Introduction</h2>
                    <p>This Privacy Policy describes how Suresh Yadav ("we", "us", "our") collects, uses, and protects information obtained during the development of ${projectName} for ${clientName} ("you", "your").</p>
                    
                    <h2>2. Information We Collect</h2>
                    <h3>2.1 Project Information</h3>
                    <p>We collect the following information for project development:</p>
                    <ul>
                        <li>Project requirements and specifications</li>
                        <li>Business processes and workflows</li>
                        <li>User interface designs and preferences</li>
                        <li>Technical requirements and constraints</li>
                        <li>Integration requirements and APIs</li>
                        <li>Testing scenarios and use cases</li>
                    </ul>
                    
                    <h3>2.2 Contact Information</h3>
                    <p>We collect contact details including:</p>
                    <ul>
                        <li>Name and company information</li>
                        <li>Email addresses and phone numbers</li>
                        <li>Communication preferences</li>
                        <li>Project-related correspondence</li>
                    </ul>
                    
                    <h3>2.3 Technical Information</h3>
                    <p>We may collect technical data such as:</p>
                    <ul>
                        <li>System configurations and environments</li>
                        <li>Database schemas and structures</li>
                        <li>API endpoints and integrations</li>
                        <li>Performance metrics and analytics</li>
                    </ul>
                    
                    <h2>3. How We Use Information</h2>
                    <p>We use collected information to:</p>
                    <ul>
                        <li>Develop and customize software solutions</li>
                        <li>Provide technical support and maintenance</li>
                        <li>Communicate project updates and progress</li>
                        <li>Ensure quality and performance standards</li>
                        <li>Comply with project requirements</li>
                        <li>Improve our development processes</li>
                    </ul>
                    
                    <h2>4. Information Sharing</h2>
                    <p>We do not share your information with third parties except:</p>
                    <ul>
                        <li>With your explicit consent</li>
                        <li>For essential project services (hosting, APIs)</li>
                        <li>To comply with legal obligations</li>
                        <li>To protect our rights and interests</li>
                        <li>In case of business transfers or mergers</li>
                    </ul>
                    
                    <h2>5. Data Security</h2>
                    <p>We implement security measures including:</p>
                    <ul>
                        <li>Encryption of sensitive data</li>
                        <li>Secure development environments</li>
                        <li>Access controls and authentication</li>
                        <li>Regular security assessments</li>
                        <li>Secure communication channels</li>
                        <li>Data backup and recovery procedures</li>
                    </ul>
                    
                    <h2>6. Data Retention</h2>
                    <p>We retain information for:</p>
                    <ul>
                        <li>Project duration and warranty period</li>
                        <li>Legal compliance requirements</li>
                        <li>Technical support purposes</li>
                        <li>Business record keeping</li>
                    </ul>
                    <p>After project completion, we may retain:</p>
                    <ul>
                        <li>Project documentation for reference</li>
                        <li>Communication records for support</li>
                        <li>Technical specifications for maintenance</li>
                    </ul>
                    
                    <h2>7. Your Rights</h2>
                    <p>You have the right to:</p>
                    <ul>
                        <li>Access your personal information</li>
                        <li>Correct inaccurate data</li>
                        <li>Request data deletion (where applicable)</li>
                        <li>Object to certain processing activities</li>
                        <li>Data portability for project deliverables</li>
                        <li>Withdraw consent for optional processing</li>
                    </ul>
                    
                    <h2>8. Cookies and Tracking</h2>
                    <p>Our development process may use:</p>
                    <ul>
                        <li>Essential cookies for functionality</li>
                        <li>Analytics cookies for improvement</li>
                        <li>Session cookies for security</li>
                        <li>Preference cookies for customization</li>
                    </ul>
                    <p>You can control cookie settings through your browser preferences.</p>
                    
                    <h2>9. Third-Party Services</h2>
                    <p>We may use third-party services for:</p>
                    <ul>
                        <li>Cloud hosting and storage</li>
                        <li>Development tools and platforms</li>
                        <li>Communication and collaboration</li>
                        <li>Payment processing</li>
                        <li>Analytics and monitoring</li>
                    </ul>
                    <p>These services have their own privacy policies that we recommend reviewing.</p>
                    
                    <h2>10. International Transfers</h2>
                    <p>If data is transferred internationally:</p>
                    <ul>
                        <li>We ensure adequate protection measures</li>
                        <li>We comply with applicable data protection laws</li>
                        <li>We use standard contractual clauses where needed</li>
                        <li>We maintain security standards across borders</li>
                    </ul>
                    
                    <h2>11. Children's Privacy</h2>
                    <p>Our services are not directed to children under 13. We do not knowingly collect personal information from children. If we become aware of such collection, we will take steps to delete the information.</p>
                    
                    <h2>12. Changes to Privacy Policy</h2>
                    <p>We may update this Privacy Policy to:</p>
                    <ul>
                        <li>Reflect changes in our practices</li>
                        <li>Comply with legal requirements</li>
                        <li>Improve clarity and transparency</li>
                        <li>Address new technologies or services</li>
                    </ul>
                    <p>We will notify you of significant changes via email or project communication channels.</p>
                    
                    <h2>13. Compliance</h2>
                    <p>We comply with applicable privacy laws including:</p>
                    <ul>
                        <li>General Data Protection Regulation (GDPR)</li>
                        <li>Nepal's data protection regulations</li>
                        <li>Industry-specific requirements</li>
                        <li>Client-specific privacy requirements</li>
                    </ul>
                    
                    <h2>14. Contact Information</h2>
                    <div class="contact-info">
                        <p><strong>Data Controller:</strong> Suresh Yadav</p>
                        <p><strong>Email:</strong> sureshyadav.info.np</p>
                        <p><strong>Services:</strong> Flutter Development, Web Development, AI Solutions</p>
                        <p><strong>Location:</strong> Nepal</p>
                    </div>
                    
                    <h2>15. Questions and Concerns</h2>
                    <p>If you have questions about this Privacy Policy or our data practices, please contact us at sureshyadav.info.np. We will respond to your inquiry within 48 hours.</p>
                    
                    <div class="footer-note">
                        <p><em>This Privacy Policy is effective as of ${currentDate} and applies to all information collected during the development of ${projectName}.</em></p>
                    </div>
                `;
            }

            createContractContent(data) {
                let content = '<h1>PROJECT DEVELOPMENT AGREEMENT</h1>';
                
                content += '<div class="highlight-box">';
                content += `<p><strong>THIS AGREEMENT</strong> is made on ${new Date().toLocaleDateString()}, between:</p>`;
                content += '<p><strong>Developer:</strong> Suresh Yadav (Flutter Developer)</p>';
                content += `<p><strong>Client:</strong> ${data.clientName || 'Client Name'}</p>`;
                content += '</div>';

                content += '<h2>1. Scope of Work</h2>';
                content += `<p>Development of <strong>${data.projectName || 'the application'}</strong>, a ${data.projectType || 'mobile application'} with the following features:</p>`;
                content += '<ul>';
                if (data.main_features && data.main_features.length > 0) {
                    data.main_features.forEach(feature => {
                        content += `<li>${this.getFeatureDisplayName(feature)}</li>`;
                    });
                }
                content += '</ul>';

                content += '<h2>2. Project Phases & Deliverables</h2>';
                content += '<ul>';
                content += '<li><strong>Phase 1:</strong> UI/UX Design and Wireframes</li>';
                content += '<li><strong>Phase 2:</strong> MVP Development</li>';
                content += '<li><strong>Phase 3:</strong> Final Release and Testing</li>';
                content += '</ul>';

                content += '<h2>3. Timeline</h2>';
                content += `<p><strong>Estimated Duration:</strong> ${data.projectTimeline || 'To be determined'}</p>`;
                content += '<p><strong>Start Date:</strong> Upon agreement signing</p>';

                content += '<h2>4. Payment Terms</h2>';
                content += `<p><strong>Total Cost:</strong> ${data.budgetRange || 'To be discussed'}</p>`;
                content += '<ul>';
                content += '<li>30% on project initiation</li>';
                content += '<li>40% after MVP completion</li>';
                content += '<li>30% on final delivery</li>';
                content += '</ul>';

                content += '<h2>5. Intellectual Property</h2>';
                content += '<p>Client owns final code, assets, and designs after full payment. Developer may reuse open-source components.</p>';

                content += '<h2>6. Warranty & Support</h2>';
                content += '<p>3 months bug-fixing warranty post-deployment. Optional maintenance can be discussed separately.</p>';

                content += '<h2>7. Change Requests</h2>';
                content += '<p>Minor UI changes are included. New features or scope changes will be billed separately.</p>';

                content += '<h2>8. Termination</h2>';
                content += '<p>Either party may terminate with written notice. Work completed up to that point must be paid.</p>';

                content += '<h2>9. Governing Law</h2>';
                content += '<p>This contract is governed by the laws of Nepal.</p>';

                content += '<div class="highlight-box">';
                content += '<h3>Signatures</h3>';
                content += '<p><strong>Developer:</strong> Suresh Yadav</p>';
                content += '<p>Date: _________________</p>';
                content += '<p><strong>Client:</strong> _________________</p>';
                content += '<p>Date: _________________</p>';
                content += '</div>';

                return content;
            }

            createPricingContent(data) {
                let content = '<h1>Project Pricing & Timeline Estimation</h1>';
                
                content += '<div class="highlight-box">';
                content += '<h2>üí∞ Cost Estimation</h2>';
                content += '<p>Based on your selected features and requirements, here is the estimated project cost:</p>';
                content += '</div>';

                content += '<h2>Total Project Cost</h2>';
                content += '<div class="highlight-box">';
                content += '<p><strong>Estimated Total:</strong> $2,500 - $5,000 USD</p>';
                content += '<p><strong>Nepal Rupees:</strong> NPR 332,500 - NPR 665,000</p>';
                content += '<p><em>Note: Final pricing will be confirmed after detailed discussion</em></p>';
                content += '</div>';

                content += '<h2>Cost Breakdown</h2>';
                content += '<div class="table-container">';
                content += '<table class="srs-table">';
                content += '<thead><tr><th>Component</th><th>Estimated Hours</th><th>Rate (USD/hour)</th><th>Cost (USD)</th></tr></thead>';
                content += '<tbody>';
                content += '<tr><td>Development</td><td>80-120</td><td>$20</td><td>$1,600 - $2,400</td></tr>';
                content += '<tr><td>UI/UX Design</td><td>20-30</td><td>$15</td><td>$300 - $450</td></tr>';
                content += '<tr><td>Testing & QA</td><td>15-25</td><td>$15</td><td>$225 - $375</td></tr>';
                content += '<tr><td>Project Management</td><td>10-15</td><td>$15</td><td>$150 - $225</td></tr>';
                content += '<tr><td>Deployment & Setup</td><td>5-10</td><td>$20</td><td>$100 - $200</td></tr>';
                content += '</tbody>';
                content += '</table>';
                content += '</div>';

                content += '<h2>Feature-Based Pricing</h2>';
                content += '<div class="table-container">';
                content += '<table class="srs-table">';
                content += '<thead><tr><th>Feature</th><th>Complexity</th><th>Estimated Hours</th><th>Cost (USD)</th></tr></thead>';
                content += '<tbody>';
                
                if (data.main_features && data.main_features.length > 0) {
                    data.main_features.forEach(feature => {
                        const featureCost = this.getFeatureCost(feature);
                        content += `<tr><td>${this.getFeatureDisplayName(feature)}</td><td>${featureCost.complexity}</td><td>${featureCost.hours}</td><td>$${featureCost.cost}</td></tr>`;
                    });
                } else {
                    content += '<tr><td colspan="4">No features selected</td></tr>';
                }
                
                content += '</tbody>';
                content += '</table>';
                content += '</div>';

                content += '<h2>‚è∞ Timeline Estimation</h2>';
                content += '<div class="highlight-box">';
                content += '<p><strong>Total Duration:</strong> 6-12 weeks</p>';
                content += '<p><strong>Working Days:</strong> 30-60 days</p>';
                content += '</div>';

                content += '<h2>Project Phases</h2>';
                content += '<div class="table-container">';
                content += '<table class="srs-table">';
                content += '<thead><tr><th>Phase</th><th>Duration</th><th>Description</th><th>Deliverables</th></tr></thead>';
                content += '<tbody>';
                content += '<tr><td>Planning & Design</td><td>1-2 weeks</td><td>Project setup, UI/UX design, architecture planning</td><td>Wireframes, Design mockups, Technical architecture</td></tr>';
                content += '<tr><td>Development</td><td>4-8 weeks</td><td>Core feature development and integration</td><td>Working app, Feature implementations</td></tr>';
                content += '<tr><td>Testing & Deployment</td><td>1-2 weeks</td><td>Quality assurance, testing, and app store deployment</td><td>Tested app, App store submission</td></tr>';
                content += '</tbody>';
                content += '</table>';
                content += '</div>';

                content += '<h2>Payment Terms</h2>';
                content += '<div class="highlight-box">';
                content += '<ul>';
                content += '<li><strong>30%</strong> - Project initiation and contract signing</li>';
                content += '<li><strong>40%</strong> - After MVP completion and client approval</li>';
                content += '<li><strong>30%</strong> - Final delivery and app store submission</li>';
                content += '</ul>';
                content += '</div>';

                content += '<h2>Additional Considerations</h2>';
                content += '<ul>';
                content += '<li>All prices are in USD and based on Nepal market rates</li>';
                content += '<li>Final pricing may vary based on specific requirements</li>';
                content += '<li>Additional features or changes will be quoted separately</li>';
                content += '<li>3 months of bug-fixing warranty included</li>';
                content += '<li>Ongoing maintenance and updates available separately</li>';
                content += '</ul>';

                return content;
            }

            createRoadmapContent(data) {
                let content = '<h1>Developer Roadmap & Implementation Guide</h1>';
                
                content += '<div class="highlight-box">';
                content += '<h2>üó∫Ô∏è Project Development Roadmap</h2>';
                content += '<p>This roadmap provides a detailed guide for implementing your project with specific timelines and daily schedules.</p>';
                content += '</div>';

                content += '<h2>Technology Stack</h2>';
                content += '<div class="table-container">';
                content += '<table class="srs-table">';
                content += '<thead><tr><th>Category</th><th>Technology</th><th>Purpose</th></tr></thead>';
                content += '<tbody>';
                content += '<tr><td>Frontend</td><td>Flutter, Dart</td><td>Cross-platform mobile development</td></tr>';
                content += '<tr><td>Backend</td><td>Node.js, Express</td><td>API and server logic</td></tr>';
                content += '<tr><td>Database</td><td>MongoDB, Firebase</td><td>Data storage and management</td></tr>';
                content += '<tr><td>State Management</td><td>Provider, Bloc</td><td>Application state management</td></tr>';
                content += '<tr><td>Tools</td><td>VS Code, Android Studio, Git</td><td>Development environment</td></tr>';
                content += '</tbody>';
                content += '</table>';
                content += '</div>';

                content += '<h2>Development Phases</h2>';
                
                // Phase 1: Project Setup
                content += '<h3>Phase 1: Project Setup & Planning (Week 1)</h3>';
                content += '<div class="highlight-box">';
                content += '<h4>Day 1-2: Project Initialization</h4>';
                content += '<ul>';
                content += '<li><strong>9:00 AM - 12:00 PM:</strong> Initialize Flutter project, set up Git repository</li>';
                content += '<li><strong>1:00 PM - 5:00 PM:</strong> Configure development environment, install dependencies</li>';
                content += '</ul>';
                content += '<h4>Day 3-4: Architecture Planning</h4>';
                content += '<ul>';
                content += '<li><strong>9:00 AM - 12:00 PM:</strong> Design application architecture and folder structure</li>';
                content += '<li><strong>1:00 PM - 5:00 PM:</strong> Set up state management and routing</li>';
                content += '</ul>';
                content += '<h4>Day 5: UI/UX Design</h4>';
                content += '<ul>';
                content += '<li><strong>9:00 AM - 12:00 PM:</strong> Create wireframes and mockups</li>';
                content += '<li><strong>1:00 PM - 5:00 PM:</strong> Design system and component library</li>';
                content += '</ul>';
                content += '</div>';

                // Phase 2: Core Development
                content += '<h3>Phase 2: Core Development (Weeks 2-6)</h3>';
                
                if (data.main_features && data.main_features.length > 0) {
                    data.main_features.forEach((feature, index) => {
                        const featureInfo = this.getFeatureRoadmap(feature);
                        content += `<h4>Feature ${index + 1}: ${this.getFeatureDisplayName(feature)}</h4>`;
                        content += '<div class="highlight-box">';
                        content += `<p><strong>Duration:</strong> ${featureInfo.duration} days</p>`;
                        content += `<p><strong>Complexity:</strong> ${featureInfo.complexity}</p>`;
                        content += '<h5>Implementation Steps:</h5>';
                        content += '<ol>';
                        featureInfo.steps.forEach(step => {
                            content += `<li><strong>${step.time}:</strong> ${step.description}</li>`;
                        });
                        content += '</ol>';
                        content += '</div>';
                    });
                }

                // Phase 3: Testing & Deployment
                content += '<h3>Phase 3: Testing & Deployment (Week 7-8)</h3>';
                content += '<div class="highlight-box">';
                content += '<h4>Week 7: Testing & Quality Assurance</h4>';
                content += '<ul>';
                content += '<li><strong>Day 1-2:</strong> Unit testing and code review</li>';
                content += '<li><strong>Day 3-4:</strong> Integration testing and bug fixes</li>';
                content += '<li><strong>Day 5:</strong> User acceptance testing</li>';
                content += '</ul>';
                content += '<h4>Week 8: Deployment & Launch</h4>';
                content += '<ul>';
                content += '<li><strong>Day 1-2:</strong> App store preparation and submission</li>';
                content += '<li><strong>Day 3-4:</strong> Production deployment and monitoring</li>';
                content += '<li><strong>Day 5:</strong> Launch and initial support</li>';
                content += '</ul>';
                content += '</div>';

                content += '<h2>Best Practices & Guidelines</h2>';
                content += '<div class="highlight-box">';
                content += '<ul>';
                content += '<li>Follow Flutter best practices and coding conventions</li>';
                content += '<li>Implement proper error handling and logging</li>';
                content += '<li>Write comprehensive unit tests for critical functions</li>';
                content += '<li>Use version control effectively with meaningful commit messages</li>';
                content += '<li>Regular code reviews and refactoring</li>';
                content += '<li>Optimize for performance and battery life</li>';
                content += '<li>Ensure accessibility compliance</li>';
                content += '</ul>';
                content += '</div>';

                content += '<h2>Common Challenges & Solutions</h2>';
                content += '<div class="table-container">';
                content += '<table class="srs-table">';
                content += '<thead><tr><th>Challenge</th><th>Solution</th><th>Prevention</th></tr></thead>';
                content += '<tbody>';
                content += '<tr><td>State Management Complexity</td><td>Use Provider or Bloc pattern</td><td>Plan state structure early</td></tr>';
                content += '<tr><td>Platform-specific Issues</td><td>Test on both iOS and Android</td><td>Use platform-specific code when needed</td></tr>';
                content += '<tr><td>Performance Issues</td><td>Profile and optimize</td><td>Follow performance best practices</td></tr>';
                content += '<tr><td>Third-party Integration</td><td>Use well-maintained packages</td><td>Research and test integrations early</td></tr>';
                content += '</tbody>';
                content += '</table>';
                content += '</div>';

                return content;
            }

            getFeatureCost(feature) {
                const featureCosts = {
                    'authentication': { complexity: 'Medium', hours: '16', cost: '320' },
                    'user_management': { complexity: 'Low', hours: '12', cost: '240' },
                    'search_filter': { complexity: 'Low', hours: '8', cost: '160' },
                    'payment_system': { complexity: 'High', hours: '24', cost: '480' },
                    'notifications': { complexity: 'Medium', hours: '10', cost: '200' },
                    'messaging': { complexity: 'High', hours: '20', cost: '400' },
                    'location_services': { complexity: 'Medium', hours: '12', cost: '240' },
                    'media_handling': { complexity: 'Medium', hours: '16', cost: '320' },
                    'social_integration': { complexity: 'Medium', hours: '14', cost: '280' },
                    'analytics': { complexity: 'Low', hours: '8', cost: '160' },
                    'offline_mode': { complexity: 'High', hours: '18', cost: '360' },
                    'admin_panel': { complexity: 'High', hours: '20', cost: '400' }
                };
                
                return featureCosts[feature] || { complexity: 'Medium', hours: '10', cost: '200' };
            }

            getFeatureRoadmap(feature) {
                const roadmaps = {
                    'authentication': {
                        duration: 3,
                        complexity: 'Medium',
                        steps: [
                            { time: 'Day 1, 9:00 AM - 12:00 PM', description: 'Design authentication UI and user flows' },
                            { time: 'Day 1, 1:00 PM - 5:00 PM', description: 'Implement login and registration forms' },
                            { time: 'Day 2, 9:00 AM - 12:00 PM', description: 'Set up backend authentication API' },
                            { time: 'Day 2, 1:00 PM - 5:00 PM', description: 'Implement password reset functionality' },
                            { time: 'Day 3, 9:00 AM - 12:00 PM', description: 'Add social login integration' },
                            { time: 'Day 3, 1:00 PM - 5:00 PM', description: 'Testing and security validation' }
                        ]
                    },
                    'user_management': {
                        duration: 2,
                        complexity: 'Low',
                        steps: [
                            { time: 'Day 1, 9:00 AM - 12:00 PM', description: 'Design user profile interface' },
                            { time: 'Day 1, 1:00 PM - 5:00 PM', description: 'Implement profile editing functionality' },
                            { time: 'Day 2, 9:00 AM - 12:00 PM', description: 'Add profile picture upload' },
                            { time: 'Day 2, 1:00 PM - 5:00 PM', description: 'Implement user preferences and settings' }
                        ]
                    },
                    'payment_system': {
                        duration: 5,
                        complexity: 'High',
                        steps: [
                            { time: 'Day 1, 9:00 AM - 12:00 PM', description: 'Research and select payment gateway' },
                            { time: 'Day 1, 1:00 PM - 5:00 PM', description: 'Set up payment gateway integration' },
                            { time: 'Day 2, 9:00 AM - 12:00 PM', description: 'Design payment flow UI' },
                            { time: 'Day 2, 1:00 PM - 5:00 PM', description: 'Implement payment processing logic' },
                            { time: 'Day 3, 9:00 AM - 12:00 PM', description: 'Add transaction history and receipts' },
                            { time: 'Day 3, 1:00 PM - 5:00 PM', description: 'Implement refund and cancellation' },
                            { time: 'Day 4, 9:00 AM - 12:00 PM', description: 'Security testing and validation' },
                            { time: 'Day 4, 1:00 PM - 5:00 PM', description: 'PCI compliance implementation' },
                            { time: 'Day 5, 9:00 AM - 5:00 PM', description: 'End-to-end testing and bug fixes' }
                        ]
                    }
                };
                
                return roadmaps[feature] || {
                    duration: 2,
                    complexity: 'Medium',
                    steps: [
                        { time: 'Day 1, 9:00 AM - 5:00 PM', description: 'Feature implementation and testing' },
                        { time: 'Day 2, 9:00 AM - 5:00 PM', description: 'Integration and final testing' }
                    ]
                };
            }

            createSummaryContent(data) {
                let content = '<h1>Project Summary & Next Steps</h1>';
                
                content += '<h2>Project Overview</h2>';
                content += '<div class="highlight-box">';
                content += `<p><strong>Project Name:</strong> ${data.projectName || 'Not specified'}</p>`;
                content += `<p><strong>Client:</strong> ${data.clientName || 'Not specified'}</p>`;
                content += `<p><strong>Project Type:</strong> ${data.projectType || 'Not specified'}</p>`;
                content += `<p><strong>Target Platforms:</strong> ${Array.isArray(data.platforms) ? data.platforms.join(', ') : data.platforms || 'Not specified'}</p>`;
                content += `<p><strong>Timeline:</strong> ${data.projectTimeline || 'To be determined'}</p>`;
                content += `<p><strong>Budget Range:</strong> ${data.budgetRange || 'To be discussed'}</p>`;
                content += '</div>';

                content += '<h2>Key Features Summary</h2>';
                content += '<ul>';
                if (data.main_features && data.main_features.length > 0) {
                    data.main_features.forEach(feature => {
                        content += `<li><strong>${this.getFeatureDisplayName(feature)}</strong></li>`;
                    });
                } else {
                    content += '<li>Features to be determined during detailed planning</li>';
                }
                content += '</ul>';

                content += '<h2>Technical Requirements</h2>';
                content += '<ul>';
                content += `<li><strong>Backend:</strong> ${data.backendRequirements || 'To be determined'}</li>`;
                content += `<li><strong>Integrations:</strong> ${Array.isArray(data.integrations) ? data.integrations.join(', ') : data.integrations || 'None specified'}</li>`;
                content += `<li><strong>Security:</strong> ${Array.isArray(data.security) ? data.security.join(', ') : data.security || 'Standard security measures'}</li>`;
                content += '</ul>';

                content += '<h2>Next Steps</h2>';
                content += '<ol>';
                content += '<li><strong>Review Documents:</strong> Carefully review the SRS and contract</li>';
                content += '<li><strong>Sign Contract:</strong> Sign the project agreement to proceed</li>';
                content += '<li><strong>Initial Payment:</strong> Make the initial payment (30%)</li>';
                content += '<li><strong>Project Kickoff:</strong> Schedule project kickoff meeting</li>';
                content += '<li><strong>Development Begins:</strong> Start the development process</li>';
                content += '</ol>';

                content += '<h2>Contact Information</h2>';
                content += '<div class="highlight-box">';
                content += '<p><strong>Developer:</strong> Suresh Yadav</p>';
                content += '<p><strong>Email:</strong> Available through contact form</p>';
                content += '<p><strong>Specialization:</strong> Flutter Development, Full-Stack Development</p>';
                content += '</div>';

                return content;
            }

            getFeatureDisplayName(feature) {
                const featureMap = {
                    'authentication': 'User Authentication & Login',
                    'user_management': 'User Profile Management',
                    'search_filter': 'Search & Filter System',
                    'payment_system': 'Payment & E-commerce',
                    'notifications': 'Push Notifications',
                    'messaging': 'In-App Messaging & Chat',
                    'location_services': 'Location & GPS Services',
                    'media_handling': 'Media & Content Handling',
                    'social_integration': 'Social Media Integration',
                    'analytics': 'Analytics & Reporting',
                    'offline_mode': 'Offline Functionality',
                    'admin_panel': 'Admin Panel & Dashboard'
                };
                return featureMap[feature] || feature;
            }

            getFeatureDescription(feature) {
                const descriptionMap = {
                    'authentication': 'authenticate and manage user accounts securely',
                    'user_management': 'manage user profiles and preferences',
                    'search_filter': 'search and filter content effectively',
                    'payment_system': 'process payments and manage transactions',
                    'notifications': 'receive push notifications',
                    'messaging': 'communicate with other users',
                    'location_services': 'access location-based features',
                    'media_handling': 'upload and manage media files',
                    'social_integration': 'integrate with social media platforms',
                    'analytics': 'view usage analytics and reports',
                    'offline_mode': 'use core features without internet connection',
                    'admin_panel': 'access administrative functions'
                };
                return descriptionMap[feature] || 'use this feature';
            }

            switchTab(tabName) {
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(`${tabName}-tab`).classList.add('active');
            }

            getCurrentDocument() {
                const activeTab = document.querySelector('.tab-btn.active');
                const tabName = activeTab ? activeTab.dataset.tab : 'srs';
                
                switch(tabName) {
                    case 'contract':
                        return this.contractDocument;
                    case 'pricing':
                        return this.pricingDocument;
                    case 'roadmap':
                        return this.roadmapDocument;
                    case 'summary':
                        return this.summaryDocument;
                    case 'terms':
                        return this.termsDocument;
                    case 'privacy':
                        return this.privacyDocument;
                    default:
                        return this.srsDocument;
                }
            }

            printCurrentDocument() {
                const currentDoc = this.getCurrentDocument();
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Document Print</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
                            h1 { color: #333; border-bottom: 2px solid #333; }
                            h2 { color: #666; border-bottom: 1px solid #666; }
                            h3 { color: #888; }
                            .highlight-box { background: #f5f5f5; padding: 15px; border: 1px solid #ddd; margin: 20px 0; }
                        </style>
                    </head>
                    <body>
                        ${currentDoc.innerHTML}
                    </body>
                    </html>
                `);
                printWindow.document.close();
                printWindow.print();
            }

            downloadCurrentDocument() {
                const currentDoc = this.getCurrentDocument();
                const activeTab = document.querySelector('.tab-btn.active');
                const tabName = activeTab ? activeTab.dataset.tab : 'srs';
                
                const blob = new Blob([`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>${tabName.toUpperCase()} Document - ${this.formData.projectName || 'Project'}</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
                            h1 { color: #333; border-bottom: 2px solid #333; }
                            h2 { color: #666; border-bottom: 1px solid #666; }
                            h3 { color: #888; }
                            .highlight-box { background: #f5f5f5; padding: 15px; border: 1px solid #ddd; margin: 20px 0; }
                        </style>
                    </head>
                    <body>
                        ${currentDoc.innerHTML}
                    </body>
                    </html>
                `], { type: 'text/html' });
                
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${tabName.toUpperCase()}_${this.formData.projectName || 'Project'}_${new Date().toISOString().split('T')[0]}.html`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            async submitSRS() {
                this.submitBtn.disabled = true;
                this.submitBtn.innerHTML = '<span class="btn-icon">‚è≥</span><span class="btn-text">Preparing Complete Package...</span>';

                try {
                    // Use the complete submission service
                    await this.completeSubmission.submitCompletePackage();
                    
                } catch (error) {
                    console.error('Error in complete submission:', error);
                    this.showToast('Error preparing submission. Please try again.', 'error');
                    this.submitBtn.disabled = false;
                    this.submitBtn.innerHTML = '<span class="btn-icon">üì§</span><span class="btn-text">Submit Complete Package</span>';
                }
            }

            async prepareCompleteDocumentPackage() {
                console.log('Preparing complete document package...');
                
                // Get all document contents
                const srsContent = this.srsDocument.innerHTML;
                const contractContent = this.contractDocument.innerHTML;
                const pricingContent = this.pricingDocument.innerHTML;
                const roadmapContent = this.roadmapDocument.innerHTML;
                const summaryContent = this.summaryDocument.innerHTML;
                
                // Create comprehensive package
                const packageData = {
                    projectInfo: {
                        projectName: this.formData.projectName || 'Not specified',
                        clientName: this.formData.clientName || 'Not specified',
                        clientEmail: this.formData.clientEmail || 'Not specified',
                        clientPhone: this.formData.clientPhone || 'Not specified',
                        projectType: this.formData.projectType || 'Not specified',
                        projectDescription: this.formData.projectDescription || 'Not specified',
                        targetAudience: this.formData.targetAudience || 'Not specified',
                        primaryMarkets: this.formData.primaryMarkets || 'Not specified',
                        platforms: Array.isArray(this.formData.platforms) ? this.formData.platforms.join(', ') : this.formData.platforms || 'Not specified',
                        mainFeatures: this.formData.main_features || [],
                        subFeatures: this.formData.sub_features || [],
                        projectTimeline: this.formData.projectTimeline || 'Not specified',
                        budgetRange: this.formData.budgetRange || 'Not specified',
                        developmentPhase: this.formData.developmentPhase || 'Not specified',
                        additionalNotes: this.formData.additionalNotes || 'None',
                        submissionDate: new Date().toLocaleString()
                    },
                    documents: {
                        srsDocument: {
                            title: 'Software Requirements Specification',
                            content: srsContent,
                            wordCount: this.getWordCount(srsContent)
                        },
                        projectAgreement: {
                            title: 'Project Agreement & Contract',
                            content: contractContent,
                            wordCount: this.getWordCount(contractContent)
                        },
                        pricingTimeline: {
                            title: 'Pricing & Timeline Estimation',
                            content: pricingContent,
                            wordCount: this.getWordCount(pricingContent)
                        },
                        developerRoadmap: {
                            title: 'Developer Roadmap & Implementation Guide',
                            content: roadmapContent,
                            wordCount: this.getWordCount(roadmapContent)
                        },
                        projectSummary: {
                            title: 'Project Summary & Overview',
                            content: summaryContent,
                            wordCount: this.getWordCount(summaryContent)
                        }
                    },
                    statistics: {
                        totalDocuments: 5,
                        totalWordCount: this.getWordCount(srsContent) + this.getWordCount(contractContent) + 
                                      this.getWordCount(pricingContent) + this.getWordCount(roadmapContent) + 
                                      this.getWordCount(summaryContent),
                        featuresCount: this.formData.main_features ? this.formData.main_features.length : 0,
                        subFeaturesCount: this.formData.sub_features ? this.formData.sub_features.length : 0
                    }
                };
                
                console.log('Complete package prepared:', packageData);
                return packageData;
            }

            getWordCount(htmlContent) {
                // Remove HTML tags and count words
                const textContent = htmlContent.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim();
                return textContent.split(' ').length;
            }

            async submitCompletePackage(packageData) {
                try {
                    // Create comprehensive email content with all documents
                    const emailContent = this.createCompleteEmailContent(packageData);
                    
                    // Submit to Web3Forms
                    await this.submitToWeb3Forms(emailContent, packageData);
                    
                } catch (error) {
                    console.error('Error submitting complete package:', error);
                    throw error;
                }
            }

            createCompleteEmailContent(packageData) {
                const { projectInfo, documents, statistics } = packageData;
                
                let content = `üéØ COMPLETE SRS PROJECT PACKAGE SUBMISSION\n`;
                content += `==========================================\n\n`;
                
                // Project Overview
                content += `üìã PROJECT OVERVIEW\n`;
                content += `-------------------\n`;
                content += `Project Name: ${projectInfo.projectName}\n`;
                content += `Client: ${projectInfo.clientName}\n`;
                content += `Email: ${projectInfo.clientEmail}\n`;
                content += `Phone: ${projectInfo.clientPhone}\n`;
                content += `Project Type: ${projectInfo.projectType}\n`;
                content += `Description: ${projectInfo.projectDescription}\n`;
                content += `Target Audience: ${projectInfo.targetAudience}\n`;
                content += `Primary Markets: ${projectInfo.primaryMarkets}\n`;
                content += `Platforms: ${projectInfo.platforms}\n`;
                content += `Timeline: ${projectInfo.projectTimeline}\n`;
                content += `Budget Range: ${projectInfo.budgetRange}\n`;
                content += `Development Phase: ${projectInfo.developmentPhase}\n`;
                content += `Submission Date: ${projectInfo.submissionDate}\n\n`;
                
                // Features Summary
                content += `üîß SELECTED FEATURES (${statistics.featuresCount} main features)\n`;
                content += `----------------------------------------\n`;
                if (projectInfo.mainFeatures && projectInfo.mainFeatures.length > 0) {
                    projectInfo.mainFeatures.forEach(feature => {
                        content += `‚Ä¢ ${this.getFeatureDisplayName(feature)}\n`;
                    });
                } else {
                    content += `‚Ä¢ No features selected\n`;
                }
                content += `\n`;
                
                // Document Statistics
                content += `üìä DOCUMENT PACKAGE STATISTICS\n`;
                content += `-----------------------------\n`;
                content += `Total Documents: ${statistics.totalDocuments}\n`;
                content += `Total Word Count: ${statistics.totalWordCount.toLocaleString()} words\n`;
                content += `Main Features: ${statistics.featuresCount}\n`;
                content += `Sub Features: ${statistics.subFeaturesCount}\n\n`;
                
                // Document Contents
                content += `üìÑ COMPLETE DOCUMENT PACKAGE\n`;
                content += `============================\n\n`;
                
                // SRS Document
                content += `1Ô∏è‚É£ SOFTWARE REQUIREMENTS SPECIFICATION\n`;
                content += `----------------------------------------\n`;
                content += `Word Count: ${documents.srsDocument.wordCount} words\n`;
                content += `Content:\n`;
                content += this.stripHtmlTags(documents.srsDocument.content);
                content += `\n\n`;
                
                // Project Agreement
                content += `2Ô∏è‚É£ PROJECT AGREEMENT & CONTRACT\n`;
                content += `--------------------------------\n`;
                content += `Word Count: ${documents.projectAgreement.wordCount} words\n`;
                content += `Content:\n`;
                content += this.stripHtmlTags(documents.projectAgreement.content);
                content += `\n\n`;
                
                // Pricing & Timeline
                content += `3Ô∏è‚É£ PRICING & TIMELINE ESTIMATION\n`;
                content += `---------------------------------\n`;
                content += `Word Count: ${documents.pricingTimeline.wordCount} words\n`;
                content += `Content:\n`;
                content += this.stripHtmlTags(documents.pricingTimeline.content);
                content += `\n\n`;
                
                // Developer Roadmap
                content += `4Ô∏è‚É£ DEVELOPER ROADMAP & IMPLEMENTATION GUIDE\n`;
                content += `--------------------------------------------\n`;
                content += `Word Count: ${documents.developerRoadmap.wordCount} words\n`;
                content += `Content:\n`;
                content += this.stripHtmlTags(documents.developerRoadmap.content);
                content += `\n\n`;
                
                // Project Summary
                content += `5Ô∏è‚É£ PROJECT SUMMARY & OVERVIEW\n`;
                content += `-----------------------------\n`;
                content += `Word Count: ${documents.projectSummary.wordCount} words\n`;
                content += `Content:\n`;
                content += this.stripHtmlTags(documents.projectSummary.content);
                content += `\n\n`;
                
                // Footer
                content += `==========================================\n`;
                content += `‚úÖ COMPLETE PACKAGE SUBMITTED SUCCESSFULLY\n`;
                content += `This comprehensive package includes all AI-generated documents\n`;
                content += `tailored specifically for this project requirements.\n`;
                content += `Generated on: ${new Date().toLocaleString()}\n`;
                
                return content;
            }

            stripHtmlTags(htmlContent) {
                // Convert HTML to plain text while preserving structure
                let text = htmlContent
                    .replace(/<h[1-6][^>]*>/g, '\n\n')
                    .replace(/<\/h[1-6]>/g, '\n')
                    .replace(/<p[^>]*>/g, '\n')
                    .replace(/<\/p>/g, '\n')
                    .replace(/<br[^>]*>/g, '\n')
                    .replace(/<li[^>]*>/g, '\n‚Ä¢ ')
                    .replace(/<\/li>/g, '')
                    .replace(/<ul[^>]*>/g, '\n')
                    .replace(/<\/ul>/g, '\n')
                    .replace(/<ol[^>]*>/g, '\n')
                    .replace(/<\/ol>/g, '\n')
                    .replace(/<div[^>]*>/g, '\n')
                    .replace(/<\/div>/g, '\n')
                    .replace(/<[^>]*>/g, '') // Remove remaining HTML tags
                    .replace(/\n\s*\n\s*\n/g, '\n\n') // Clean up multiple newlines
                    .replace(/^\s+|\s+$/g, '') // Trim
                    .substring(0, 5000); // Limit length for email
                
                return text;
            }

            async submitToWeb3Forms(emailContent) {
                try {
                    const formData = new FormData();
                    formData.append('access_key', '7f6edf0a-47e0-49a4-bebf-2a8be167a68b');
                    formData.append('subject', 'New SRS Form Submission - Flutter Project');
                    formData.append('from_name', this.formData.clientName || 'SRS Form');
                    formData.append('message', emailContent);
                    formData.append('redirect', 'true');
                    formData.append('redirect_url', '../index.html?submitted=true');

                    const response = await fetch('https://api.web3forms.com/submit', {
                        method: 'POST',
                        body: formData
                    });

                    if (response.ok) {
                        this.showToast('SRS submitted successfully! I\'ll review your requirements and get back to you soon.', 'success');
                        setTimeout(() => {
                            window.location.href = '../index.html?submitted=true';
                        }, 3000);
                    } else {
                        throw new Error('Failed to submit form');
                    }
                } catch (error) {
                    console.error('Form submission error:', error);
                    
                    // Fallback for CORS issues
                    if (error.message.includes('CORS') || error.message.includes('Failed to fetch')) {
                        const tempForm = document.createElement('form');
                        tempForm.method = 'POST';
                        tempForm.action = 'https://api.web3forms.com/submit';
                        tempForm.target = '_blank';
                        
                        for (let [key, value] of formData.entries()) {
                            const input = document.createElement('input');
                            input.type = 'hidden';
                            input.name = key;
                            input.value = value;
                            tempForm.appendChild(input);
                        }
                        
                        document.body.appendChild(tempForm);
                        tempForm.submit();
                        document.body.removeChild(tempForm);
                        
                        this.showToast('SRS submitted successfully! Check your email.', 'success');
                    } else {
                        this.showToast(`Submission failed: ${error.message}`, 'error');
                    }
                } finally {
                    this.submitBtn.disabled = false;
                    this.submitBtn.innerHTML = '<span class="btn-icon">üìß</span><span class="btn-text">Submit SRS & Get Contract</span>';
                }
            }

            showTestButton() {
                this.loadingMessage.style.display = 'none';
                this.testSection.style.display = 'block';
            }

            loadTestData() {
                this.formData = {
                    projectName: 'Test Mobile App',
                    clientName: 'Test Client',
                    clientEmail: 'test@example.com',
                    projectType: 'Mobile Application',
                    projectDescription: 'A test mobile application for demonstration purposes',
                    targetAudience: 'General users',
                    primaryMarkets: 'Global',
                    platforms: ['Android', 'iOS'],
                    main_features: ['authentication', 'user_management', 'search_filter', 'notifications'],
                    projectTimeline: '3-6 months',
                    budgetRange: '$5000-$10000',
                    developmentPhase: 'Full Development',
                    additionalNotes: 'This is test data for demonstration'
                };
                
                this.testSection.style.display = 'none';
                this.generateDocuments();
            }

            forceRefresh() {
                console.log('Force refresh requested...');
                
                // Clear all localStorage
                localStorage.clear();
                console.log('localStorage cleared');
                
                // Clear any cached data
                this.formData = null;
                
                // Force page reload with cache busting
                const url = new URL(window.location);
                url.searchParams.set('t', Date.now().toString());
                window.location.href = url.toString();
            }

            showError(message) {
                this.loadingMessage.style.display = 'none';
                this.errorMessage.style.display = 'block';
                this.errorMessage.querySelector('p').textContent = message;
            }

            showToast(message, type = 'info') {
                const toast = document.getElementById('toast');
                toast.textContent = message;
                toast.className = `toast toast-${type}`;
                toast.style.display = 'block';
                
                setTimeout(() => {
                    toast.style.display = 'none';
                }, 4000);
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new SRSPreview();
        });
    </script>
</body>
</html>